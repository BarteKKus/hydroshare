{% load geoanalytics_tags hydroshare_tags %}

{% if not metadata_form %}
    <div class="col-lg-6 col-xs-12">
        <div class="row">
            <div class="col-sm-12 col-xs-12 content-block" id="coverage-spatial">
                <div class="row">
                    <div class="col-sm-12">
                        <div>
                            <div>{% if spatial_coverage.name %}{{ spatial_coverage.name }}{% endif %}</div>
                            {% if temporal_coverage %}
                            <small class="text-muted">

                                <i class="fa fa-calendar" aria-hidden="true"></i> Start Date:&nbsp;
                                    <strong class="format-date" data-date="{{ temporal_coverage.start_date }}"></strong>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                    <i class="fa fa-calendar" aria-hidden="true"></i>
                                    &nbsp;End Date:&nbsp;
                                    <strong class="format-date" data-date="{{ temporal_coverage.end_date }}"></strong>

                            </small>
                            {% endif %}
                        </div>
                        <div id="coverageMap" data-mode="view" data-shape-type="{{ spatial_coverage.type }}"></div>
                        <i id="resetZoomBtn" class="glyphicon glyphicon-record" data-toggle="tooltip"
                           data-placement="left" title="Recenter on selected area/point"></i>
                    </div>

                    {% if spatial_coverage.north or spatial_coverage.northlimit %}
                        <div class="coordinates-list-container">
                            <ul class="list-group">
                                {% if spatial_coverage.type == 'point' %}
                                    {% if spatial_coverage.east %}
                                        <li class="list-group-item"><strong>Longitude</strong>
                                            <div id="cov_east">{{ spatial_coverage.east }}°</div>
                                        </li>
                                    {% endif %}
                                    {% if spatial_coverage.north %}
                                        <li class="list-group-item"><strong>Latitude</strong>
                                            <div id="cov_north">{{ spatial_coverage.north }}°</div>
                                        </li>
                                    {% endif %}
                                {% else %}
                                    {% if spatial_coverage.northlimit %}
                                        <li class="list-group-item"><strong>North Latitude</strong>
                                            <div id="cov_northlimit">{{ spatial_coverage.northlimit }}°</div>
                                        </li>
                                    {% endif %}
                                    {% if spatial_coverage.eastlimit %}
                                        <li class="list-group-item"><strong>East Longitude</strong>
                                            <div id="cov_eastlimit">{{ spatial_coverage.eastlimit }}°</div>
                                        </li>
                                    {% endif %}
                                    {% if spatial_coverage.southlimit %}
                                        <li class="list-group-item"><strong>South Latitude</strong>
                                            <div id="cov_southlimit">{{ spatial_coverage.southlimit }}°</div>
                                        </li>
                                    {% endif %}
                                    {% if spatial_coverage.westlimit %}
                                        <li class="list-group-item"><strong>West Longitude</strong>
                                            <div id="cov_westlimit">{{ spatial_coverage.westlimit }}°</div>
                                        </li>
                                    {% endif %}
                                {% endif %}
                            </ul>
                        </div>
                        <div class="text-muted col-sm-12">
                                {% if spatial_coverage.projection %}
                                    <small>{{ spatial_coverage.projection }}</small>
                                {% endif %}
                                {% if spatial_coverage.units %}
                                    <small>{{ spatial_coverage.units }}</small>
                                {% endif %}
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
{% else %}
    <div class="form-group">
        <div class="col-lg-6 col-xs-12">
            <div class="row">
                <div id="readonly-coverage-notice" class="col-xs-12 alert alert-warning alert-dismissible"
                     style="display: none;">
                    <label>Spatial coverage for time series resources should be set by editing the coordinates of the monitoring
                        sites on the "Resource Specific" metadata tab. </label>
                </div>

                <div class="col-xs-12 content-block" id="coverage-spatial">
                    <div class="row">
                        <form action="/hsapi/_internal/{{ cm.short_id }}/coverage/{% if not coverage_spatial_form.initial.north and not coverage_spatial_form.initial.northlimit %}add-metadata/
                            {% else %}{{ coverage_spatial_form.initial.id }}/update-metadata/{% endif %}"
                              id="id-coverage-spatial" method="post">
                            {% csrf_token %}
                            <div class="col-sm-12">
                                <h3>Coverage</h3>

                                <input id="id_projection" maxlength="100" name="projection"
                                       type="text" style="display:none"
                                       value="{% if coverage_spatial_form.initial.projection %}{{ coverage_spatial_form.initial.projection }}{% else %}WGS 84 EPSG:4326{% endif %}">
                                <input id="id_units" maxlength="50" name="units"
                                       style="display:none"
                                       type="text" value="{% if coverage_spatial_form.initial.units %}{{ coverage_spatial_form.initial.units }}{% endif %}">
                            </div>

                            <fieldset>
                                <div class="col-sm-8">
                                    <div id="div_id_name" class="control-group">
                                        <label for="id_name" class="control-label">Place/Area Name</label>

                                        <div class="controls">
                                            <input class="form-control input-sm textinput textInput"
                                                   id="id_name" maxlength="200" name="name" type="text"
                                                   value="{% if coverage_spatial_form.initial.name %}{{ coverage_spatial_form.initial.name }}{% endif %}">
                                        </div>

                                        <div id="div_id_type">
                                            <label class="radio-inline">
                                                <input type="radio"
                                                       {% if coverage_spatial_form.initial.type == "box" %}checked="checked"{% endif %}
                                                       name="type" id="id_type_1"
                                                       value="box">Box</label>

                                            <label class="radio-inline">
                                                <input type="radio"
                                                       {% if coverage_spatial_form.initial.type == "point" %}checked="checked"{% endif %}
                                                       name="type" id="id_type_2"
                                                       value="point">Point</label>
                                        </div>
                                    </div>
                                    <div id="coverageMap"></div>
                                    <i id="resetZoomBtn" class="glyphicon glyphicon-record" data-toggle="tooltip"
                                       data-placement="left" title="Recenter on selected area/point"></i>
                                </div>

                                <div class="col-sm-4">

                                    {% if spatial_coverage.projection %}
                                        <small class="text-muted">WGS 84 EPSG:4326</small>
                                        <br>
                                    {% endif %}
                                    {% if spatial_coverage.units %}
                                        <small class="text-muted">Decimal degrees</small>
                                        <br>
                                    {% endif %}
                                    <br>
                                    <div id="div_id_north" class="control-group" style="margin-bottom: 10px;">
                                        <label for="id_north" class="control-label requiredField">
                                            Latitude<span class="asteriskField">*</span>
                                        </label>

                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="-90 to 90"
                                                   id="id_north" name="north"
                                                   value="{% if coverage_spatial_form.initial.north %}{{ coverage_spatial_form.initial.north }}{% endif %}">
                                            <span data-toggle="tooltip" data-placement="auto" title="WGS 84 decimal degrees"
                                                  class="input-group-addon">°</span>
                                        </div>
                                    </div>
                                    <div id="div_id_east" class="control-group" style="margin-bottom: 10px;">
                                        <label for="id_east" class="control-label requiredField">
                                            Longitude<span class="asteriskField">*</span>
                                        </label>

                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="-180 to 180"
                                                   id="id_east" name="east"
                                                   value="{% if coverage_spatial_form.initial.east %}{{ coverage_spatial_form.initial.east }}{% endif %}">
                                            <span data-toggle="tooltip" data-placement="auto" title="WGS 84 decimal degrees"
                                                  class="input-group-addon">°</span>
                                        </div>
                                    </div>
                                    <div id="div_id_northlimit" class="control-group" style="margin-bottom: 10px;">
                                        <label for="id_northlimit" class="control-label requiredField">
                                            North Latitude<span class="asteriskField">*</span>
                                        </label>

                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="-90 to 90"
                                                   id="id_northlimit" name="northlimit"
                                                   value="{% if coverage_spatial_form.initial.northlimit %}{{ coverage_spatial_form.initial.northlimit }}{% endif %}">
                                            <span data-toggle="tooltip" data-placement="auto" title="WGS 84 decimal degrees"
                                                  class="input-group-addon">°</span>
                                        </div>
                                    </div>
                                    <div id="div_id_eastlimit" class="control-group" style="margin-bottom: 10px;">
                                        <label for="id_eastlimit" class="control-label requiredField">
                                            East Longitude<span class="asteriskField">*</span>
                                        </label>

                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="-180 to 180"
                                                   id="id_eastlimit" name="eastlimit"
                                                   value="{% if coverage_spatial_form.initial.eastlimit %}{{ coverage_spatial_form.initial.eastlimit }}{% endif %}">
                                            <span data-toggle="tooltip" data-placement="auto" title="WGS 84 decimal degrees"
                                                  class="input-group-addon">°</span>
                                        </div>
                                    </div>
                                    <div id="div_id_southlimit" class="control-group" style="margin-bottom: 10px;">
                                        <label for="id_southlimit" class="control-label requiredField">
                                            South Latitude<span class="asteriskField">*</span>
                                        </label>

                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="-90 to 90"
                                                   id="id_southlimit" name="southlimit"
                                                   value="{% if coverage_spatial_form.initial.southlimit %}{{ coverage_spatial_form.initial.southlimit }}{% endif %}">
                                            <span data-toggle="tooltip" data-placement="auto" title="WGS 84 decimal degrees"
                                                  class="input-group-addon">°</span>
                                        </div>
                                    </div>
                                    <div id="div_id_westlimit" class="control-group" style="margin-bottom: 10px;">
                                        <label for="id_westlimit" class="control-label requiredField">
                                            West Longitude<span class="asteriskField">*</span>
                                        </label>

                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="-180 to 180"
                                                   id="id_westlimit" name="westlimit"
                                                   value="{% if coverage_spatial_form.initial.westlimit %}{{ coverage_spatial_form.initial.westlimit }}{% endif %}">
                                            <span data-toggle="tooltip" data-placement="auto" title="WGS 84 decimal degrees"
                                                  class="input-group-addon">°</span>
                                        </div>
                                    </div>


                                    <button type="button" class="btn btn-primary pull-right"
                                            onclick="metadata_update_ajax_submit('id-coverage-spatial'); return false;"
                                            style="display: none;">Save changes
                                    </button>

                                </div>
                            </fieldset>
                        </form>
                    </div>
                </div>

                <div class="col-xs-12"><hr></div>

                <div class="form-group col-xs-12 content-block" id="coverage-temporal">
                    {% if not coverage_temporal_form.initial.start %}
                        <form action="/hsapi/_internal/{{ cm.short_id }}/coverage/add-metadata/"
                              id="id-coverage-temporal" method="post">
                            {% csrf_token %}
                            <fieldset>
                                <div id="div_id_start" class="control-group">
                                    <label for="id_start" class="control-label requiredField">
                                        Start Date<span class="asteriskField">*</span></label>

                                    <div class="controls">
                                        <input class="form-control input-sm dateinput" id="id_start"
                                               name="start" type="text">
                                    </div>
                                </div>
                                <div id="div_id_end" class="control-group">
                                    <label for="id_end" class="control-label requiredField">End
                                        Date<span class="asteriskField">*</span></label>

                                    <div class="controls">
                                        <input class="form-control input-sm dateinput" id="id_end"
                                               name="end" type="text">
                                    </div>
                                </div>
                                <div style="margin-top:10px">
                                    <button type="button" class="btn btn-primary pull-right"
                                            onclick="metadata_update_ajax_submit('id-coverage-temporal'); return false;">
                                        Save changes
                                    </button>
                                </div>
                            </fieldset>
                        </form>
                    {% else %}
                        <form action="/hsapi/_internal/{{ cm.short_id }}/coverage/{{ coverage_temporal_form.initial.id }}/update-metadata/"
                              id="id-coverage-temporal" method="post">
                            {% csrf_token %}
                            <fieldset>
                                <div class="row">
                                    <div id="div_id_start" class="control-group col-xs-4">
                                        <label for="id_start" class="control-label requiredField">
                                            Start Date<span class="asteriskField">*</span></label>

                                        <div class="controls">
                                            <input class="form-control input-sm dateinput" id="id_start"
                                                   name="start" type="text" data-date="{{ coverage_temporal_form.initial.start}}"
                                                   >
                                        </div>
                                    </div>
                                    <div id="div_id_end" class="control-group col-xs-4">
                                        <label for="id_end" class="control-label requiredField">End
                                            Date<span class="asteriskField">*</span></label>

                                        <div class="controls">
                                            <input class="form-control input-sm dateinput" id="id_end"
                                                   name="end" type="text" data-date="{{ coverage_temporal_form.initial.end }}"
                                                   >
                                        </div>
                                    </div>
                                    <div style="margin-top:20px" class="col-xs-4">
                                        <button type="button" class="btn btn-primary pull-right"
                                                onclick="metadata_update_ajax_submit('id-coverage-temporal'); return false;"
                                                style="display: none;">Save changes
                                        </button>
                                    </div>
                                </div>

                            </fieldset>
                        </form>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

{% endif %}