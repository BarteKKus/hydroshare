{% extends "base.html" %}
{% load pages_tags mezzanine_tags keyword_tags comment_tags hydroshare_tags %}
{% block meta_title %}Discover{% endblock %}
{% block main %}

    <style type="text/css">
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }

      /* Optional: Makes the sample page fill the window. */
      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
    <script>
      (function(exports) {
        "use strict";

        function initMap() {
          exports.map = new google.maps.Map(document.getElementById("discover-map"), {
            center: {
              lat: -34.397,
              lng: 150.644
            },
            zoom: 8
          });
        }

        exports.initMap = initMap;
      })((this.window = this.window || {}));
    </script>
    <input type="hidden" id="static-url" value="{{ STATIC_URL }}">
    <div class="container" id="discover-main">
        <div class="row">
            <div class="col-xs-12">
                <h2 class="page-title">Discover
                    <small class="text-muted"><i>Public resources shared with the community.</i></small>
                </h2>
                <div id="app"></div>
            </div>
        </div>
        <br>
        <div class="alert alert-info">
            <strong>
                <i class="glyphicon glyphicon-question-sign"></i> Not finding what you are looking for?
            </strong>
            <p class="space-top">Private resources owned by you or shared with you by colleagues are
                searchable from
                <strong><a href="/my-resources">My Resources</a></strong></p>
        </div>
        {% include "includes/legend.html" %}
    </div>
    <div id="map-view" class="tab-pane fade">
        <div class="row">
            <div class="col-xs-12">
                <span id="discover-map-loading-spinner" class="discover-loading-icon icon-blue">
                      <i class="fa fa-spinner fa-spin fa-2x fa-fw"></i>
                </span>
                <br/>
                <form id="covereage-search-fields" method="get" action="." class="hidden">
                    {% for field in form %}
                    {% if field.auto_id == "id_NElat" or field.auto_id == "id_NElng" or field.auto_id == "id_SWlat" or
                    field.auto_id == "id_SWlng" %}
                    {{ field }}
                    {% endif %}
                    {% endfor %}
                </form>

                <div id="geocoder-panel"></div>

                <div id="discover-map"></div>

                <div id="discover-map-legend"></div>

                <div id="resetZoom"></div>
                <br/>
                <table class="table-hover table-striped" id="map-items" style="width:100%; max-height:200px">
                </table>
            </div>
        </div>
    </div>
    <script src=/static/js/chunk-vendors.js></script>
    <script src=/static/js/app.js></script>
<link rel="stylesheet" type="text/css" href="/static/css/jquery.dataTables.min.css">
<script type="text/javascript" src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <script src="https://maps.googleapis.com/maps/api/js?v=3&libraries=geometry,places&key=AIzaSyBv1tggGSW3-12h6vkbo8BL711KaUnG1w0" type="text/javascript"></script>
    <script src=/static/js/map.js></script>
{% endblock %}
