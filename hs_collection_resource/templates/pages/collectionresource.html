{% extends "pages/genericresource.html" %}
{% load geoanalytics_tags pages_tags mezzanine_tags crispy_forms_tags %}

{#{% block tools %}#}
{#{% endblock %}#}

{% block content %}
{% endblock %}

{#{% block extra_content %}#}
{#{% endblock %}#}

{% block extended_metadata %}
    {% if extended_metadata_exists %}
        <div class="row">
            <div class="col-md-12">
                <div>
                    {% if collection_items %}
                        <h4><strong>Collection Items:</strong></h4>
                        <hr style="margin-top: 0px;margin-bottom: 2px">
                        <div class="row">
                        {% autoescape off %}
                            <div class="col-sm-8">{{ collection_items }}</div>
                        {% endautoescape %}

                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    {%  endif %}
{%  endblock %}

{% block extra_js %}
    {{ block.super }}
    <div id="checked_res_div" hidden="true">{{ checked_res }}</div>
    {# put resource specific js below #}
    <script type="text/javascript">
        $(document).ready(function(){


             $('#add').click(function(e) {
                var selectedOpts = $('#select1 option:selected');
                if (selectedOpts.length == 0) {
                    e.preventDefault();
                }

                $('#select2').append($(selectedOpts).clone());
                $(selectedOpts).remove();
                e.preventDefault();
            });


            $('#remove').click(function(e) {
                var selectedOpts = $('#select2 option:selected');
                if (selectedOpts.length == 0) {
                    e.preventDefault();
                }


                $('#select1').append($(selectedOpts).clone());
                $(selectedOpts).remove();
                e.preventDefault();
            });

            $('#save').click(function() {
                $('#select2 option').each(function () {
                $(this).attr('selected', true);
                });

                metadata_update_ajax_submit("collector"); return false;
{#                 all_options = []#}
{#                $('#select2 option').each(function () {#}
{#                    all_options.push($(this).val())#}
{#                });#}
{#                var collection_resource_id = $("#collection_res_id").val();#}
{##}
{#                $.ajax({#}
{#                    url: '/hsapi/_internal/update-collection/',#}
{#                    type: 'POST',#}
{#                    dataType: 'json',#}
{#                    data: {all_options:all_options,collection_resource_id:collection_resource_id},#}
{#                    success: function(data){#}
{##}
{#                    }#}
{#    });#}

            });

{#            var checked_res_str=$("#checked_res_div").text();#}
{#            var checked_res_array=checked_res_str.split(",");#}
{#            for (var i = 0; i < checked_res_array.length; i++)#}
{#            {#}
{#                var checked_res_item=checked_res_array[i];#}
{#                $("input[value='"+checked_res_item+"']").attr("checked","true");#}
{#            }#}
        })
    </script>
{% endblock %}